<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ìˆ˜í™”í†µì—­ ì—°ìŠµ | ë¬¸ì¥ ì—°ìŠµ</title>
  <style>
    body{margin:0;font-family:sans-serif;background:#0f172a;color:#fff;display:flex;justify-content:center;align-items:center;height:100vh}
    .card{background:#111827;padding:20px;border-radius:12px;box-shadow:0 0 20px #0006;max-width:800px;width:100%}
    button{padding:10px 20px;margin:6px;border-radius:8px;border:none;font-size:16px;cursor:pointer}
    button.primary{background:#22d3ee;color:#00343c;font-weight:bold}
    .sentence{margin:20px 0;font-size:22px}
    video{width:100%;border-radius:12px;background:#000;display:none}
  </style>
</head>
<body>

  <div id="app" class="card">
    <h2>ë¬¸ì¥ ì—°ìŠµ (ìë™ ìŒì„±)</h2>
    <div class="sentence" id="sentence">ë¡œë”© ì¤‘...</div>
    <video id="video" controls></video>
    <div class="controls">
      <button id="btnShuffle">ğŸ”€ ì „ì²´ ì…”í”Œ</button>
      <button id="btnRestart">â® ì²˜ìŒë¶€í„°</button>
      <button id="btnPrev">â—€ ì´ì „</button>
      <button id="reSpeakBtn">ğŸ”Š ë‹¤ì‹œ ë“£ê¸°</button>
      <button id="revealBtn">ì •ë‹µ(ì˜ìƒ) ë³´ê¸°</button>
      <button id="btnNext" class="primary">ë‹¤ìŒ â–¶</button>
    </div>
  </div>

<script>
  const CARDS = [
    { k: "ì•„ì´ê³ , ì•„ë¿”ì‹¸", ex: "ê°€: ì˜¤í›„ì— ë¹„ê°€ ë‚´ë¦°ë‹¤ëŠ”ë°, ìš°ì‚° ì±™ê²¼ì–´? ë‚˜: ì•„ì´ê³ . ê¹œë¹¡í–ˆë„¤.", src: "https://ksldict.korean.go.kr/kslserv/signFile/video/exmp/202411/a3mFRN8ardsnitaQ.mp4" },
    { k: "ê°•ì•„ì§€", ex: "ê°•ì•„ì§€ ì‚°ì±…ì€ í•˜ë£¨ì— 30ë¶„ì—ì„œ 1ì‹œê°„ì´ ê±´ê°•ì„ ìœ„í•´ í•„ìš”í•©ë‹ˆë‹¤.", src: "https://test-videos.co.uk/vids/bigbuckbunny/mp4/h264/360/Big_Buck_Bunny_360_10s_1MB.mp4" },
    { k: "ë‰´ìš• ì „ì² ", ex: "ë¯¸êµ­ ë‰´ìš•ì˜ ì „ì² ì´ í™ìˆ˜ë¡œ ì¹¨ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.", src: "https://test-videos.co.uk/vids/bigbuckbunny/mp4/h264/360/Big_Buck_Bunny_360_10s_1MB.mp4" }
  ];

  let idx = 0; let selectedVoice = null;
  const sentence = document.getElementById('sentence');
  const video = document.getElementById('video');

  function shuffle(arr){
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
    return arr;
  }

  function speak(text){
    if (!('speechSynthesis' in window)) return;
    try { speechSynthesis.cancel(); } catch(e){}
    if (!text) return;
    const u = new SpeechSynthesisUtterance(text);
    if (selectedVoice) u.voice = selectedVoice;
    u.lang = (selectedVoice?.lang) || 'ko-KR';
    u.rate = 1; u.pitch = 1;
    speechSynthesis.speak(u);
  }

  function loadVoices(){
    if (!('speechSynthesis' in window)) return;
    const voices = speechSynthesis.getVoices();
    selectedVoice = voices.find(v => /ko|Korean|í•œêµ­ì–´/i.test((v.lang||'') + ' ' + (v.name||''))) || voices[0] || null;
  }
  if ('speechSynthesis' in window){
    speechSynthesis.onvoiceschanged = loadVoices;
    loadVoices();
  }

  function updateView(){
    const item = CARDS[idx];
    const text = item.ex || item.k;
    sentence.textContent = text;
    video.pause();
    video.style.display = 'none';
    speak(text);
  }

  // === ë²„íŠ¼ ì´ë²¤íŠ¸ ===
  document.getElementById('btnShuffle').addEventListener('click', () => {
    shuffle(CARDS);   // ì „ì²´ ì…”í”Œ
    idx = 0;         // ì²˜ìŒë¶€í„° ì‹œì‘
    updateView();
  });

  document.getElementById('btnRestart').addEventListener('click', () => {
    idx = 0;         // ì²˜ìŒìœ¼ë¡œ ì´ë™
    updateView();
  });

  document.getElementById('btnPrev').addEventListener('click', () => {
    idx = (idx - 1 + CARDS.length) % CARDS.length; // ì´ì „
    updateView();
  });

  document.getElementById('reSpeakBtn').addEventListener('click', () => {
    const item = CARDS[idx];
    speak(item.ex || item.k);
  });

  document.getElementById('revealBtn').addEventListener('click', () => {
    const item = CARDS[idx];
    if (!item.src) return;
    video.src = item.src;
    video.style.display = 'block';
    video.play().catch(()=>{});
  });

  document.getElementById('btnNext').addEventListener('click', () => {
    idx = (idx + 1) % CARDS.length; // ë‹¤ìŒ
    updateView();
  });

  // ì´ˆê¸° ì‹¤í–‰: ì²« ë¡œë“œ ì‹œ ìë™ ì…”í”Œ + ì²« ë¬¸ì¥ ìŒì„±
  shuffle(CARDS);
  idx = 0;
  updateView();
</script>

</body>
</html>
